(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90475,       2230]
NotebookOptionsPosition[     90122,       2216]
NotebookOutlinePosition[     90517,       2232]
CellTagsIndexPosition[     90474,       2229]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isIL", "[", "g_Graph", "]"}], ":=", 
    RowBox[{"isIL", "[", 
     RowBox[{
      RowBox[{"getVtxPairsFromGraph", "[", "g", "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "True", " ", "if", " ", "the", " ", "graph", " ", "is", 
    " ", "IL"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isIL", "[", "edgeListInput_List", "]"}], ":=", 
    RowBox[{"isIL", "[", 
     RowBox[{"edgeListInput", " ", ",", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isIL", "[", 
     RowBox[{"edgeListInput_List", ",", " ", "crossingsInput_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "edgeList", " ", "and", " ", "crossings", " ", "are", " ", "global"}],
         ",", " ", 
        RowBox[{"used", " ", "in", " ", "doSetUp"}], ",", " ", "doMainLoop", 
        ",", " ", 
        RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"edgeList", "=", 
        RowBox[{"pushDownVertices", "[", 
         RowBox[{"Sort", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Sort", ",", "edgeListInput"}], "]"}], "]"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"edgeList", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", "edgeList"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"edgeList", "=", 
        RowBox[{"removeVtxsDeg2orLess", "[", "edgeList", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"edgeList", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"hasTooManyEdgesToBeNIL", "[", "edgeList", "]"}], ",", 
         RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"hasApexDescendant", "[", "edgeList", "]"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"crossings", "=", "crossingsInput"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doSetUp", "[", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"doMainLoop", "[", "]"}], "\[Equal]", "1"}], ",", " ", 
         RowBox[{"Return", "[", "True", "]"}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getVtxPairsFromGraph", "[", "g_Graph", "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"List", ",", 
      RowBox[{"EdgeList", "[", "g", "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getGraphFromVtxPairs", "[", "vtxPairs_List", "]"}], ":=", 
   RowBox[{"Graph", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"UndirectedEdge", ",", "#"}], "]"}], "&"}], ",", "vtxPairs", 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"graphWithVtxLabels", "[", "g_Graph", "]"}], ":=", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"EdgeList", "[", "g", "]"}], ",", 
      RowBox[{"VertexLabels", "\[Rule]", "All"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "===", "==="}], 
    "="}], " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hasTooManyEdgesToBeNIL", "[", "vtxPairs_List", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"EdgeCount", "[", 
       RowBox[{"getGraphFromVtxPairs", "[", "vtxPairs", "]"}], "]"}], ">", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"VertexCount", "[", 
         RowBox[{"getGraphFromVtxPairs", "[", "vtxPairs", "]"}], "]"}]}], "-",
        "10"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hasApexDescendant", "[", "vtxPairs_List", "]"}], ":=", 
   RowBox[{"hasApexDescendant", "[", 
    RowBox[{"getGraphFromVtxPairs", "[", "vtxPairs", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hasApexDescendant", "[", "g_Graph", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vtxs", ",", "vtxPairs", ",", "triangles", ",", "trianglePairs", ",", 
       "result", ",", "h"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Return", " ", "True", " ", "if", " ", "g", " ", "is", " ", "1"}], "-", 
       RowBox[{"apex", " ", "or", " ", "has", " ", "a", " ", "1"}], "-", 
       RowBox[{"apex", " ", "descendant"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtxs", "=", 
       RowBox[{"VertexList", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "first", " ", "check", " ", "if", " ", "g", " ", "is", " ", "1"}], 
         "-", "apex"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PlanarGraphQ", "[", 
           RowBox[{"VertexDelete", "[", 
            RowBox[{"g", ",", "v"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"result", "=", "True"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "vtxs"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", 
      RowBox[{"(*", "Do", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"result", "==", "True"}], ",", " ", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"triangles", "=", 
       RowBox[{"FindCycle", "[", 
        RowBox[{"g", ",", 
         RowBox[{"{", "3", "}"}], ",", "All"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{"(*", 
        RowBox[{
        "check", " ", "if", " ", "removing", " ", "one", " ", "triangle", " ",
          "gives", " ", "planar", " ", "graph"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"PlanarGraphQ", "[", 
            RowBox[{"EdgeDelete", "[", 
             RowBox[{"g", ",", "t"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"result", "=", "True"}], ";", 
            RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "triangles"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", 
      RowBox[{"(*", "Do", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"Module", " ", "hasApexDescendant"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getChordless2Links", "[", "edgeListInput_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "allCycles", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVtxs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"edgeListInput", "//", "Flatten"}], "//", "Union"}], "//", 
        "Length"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"allCycles", "=", 
       RowBox[{"First", "@", 
        RowBox[{"getChordlessCycsAndPaths", "[", 
         RowBox[{"getGraphFromVtxPairs", "[", "edgeListInput", "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allCycles", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "&"}], ",", "allCycles"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "append", " ", "the", " ", "1", "st", " ", "element", " ", "of", " ", 
        "each", " ", "cycle", " ", "to", " ", "the", " ", "end", " ", "of", 
        " ", "that", " ", "cycle"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allCycles", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], "\[LessEqual]", 
             RowBox[{"numVtxs", "-", "2"}]}], ",", "#", ",", "Nothing"}], 
           "]"}], "&"}], ",", "allCycles"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"why", " ", "it", " ", "says", " ", "numVtxs"}], "-", "2"}],
          " ", ":", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"In", " ", "a", " ", "2"}], "-", 
          RowBox[{"component", " ", "link"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "each", " ", "cycle", " ", "has", " ", "at", " ", "most", " ", 
           "numVtxs"}], "-", 
          RowBox[{"3", " ", "vtxs"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"here", " ", "we", " ", "have", " ", "numVtxs"}], "-", 
          RowBox[{
          "2", " ", "because", " ", "the", " ", "first", " ", "vertex", " ", 
           "is", " ", "repeated", " ", "at", " ", "the", " ", "end", " ", 
           "of", " ", "each", " ", 
           RowBox[{"cycle", "."}]}]}]}]}], "\[IndentingNewLine]", " ", "*)"}],
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "the", " ", "line", " ", "below", " ", "used", " ", "to", " ", "be", 
        " ", "in", " ", "the", " ", "older", " ", "version", " ", "of", " ", 
        "isIL"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"allCycles", "=", 
         RowBox[{"getChordlessCycsFromCycs", "[", 
          RowBox[{
           RowBox[{"getCycsOfLenL", "[", 
            RowBox[{"edgeListInput", ",", 
             RowBox[{"numVtxs", "-", "3"}]}], "]"}], ",", "edgeListInput"}], 
          "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"doCycleIntersections", "[", "allCycles", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"getLinksFullFormat", "[", "allCycles", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", "Module", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getChordlessCycsAndPaths", "[", "g_Graph", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chordlessPaths", ",", " ", "chordlessCycs", ",", "nbrsLists", ",", " ",
        "pIndex", ",", "p", ",", "initialVtx", ",", "terminalVtx", ",", 
       "newCycOrPath"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nbrsLists", "=", 
       RowBox[{"getNbrsOfEachVtx", "[", "g", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "nbrsLists", "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}], 
        " ", "is", " ", "a", " ", "list", " ", "of", " ", "nbrs", " ", "of", 
        " ", "v"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"chordlessPaths", "=", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", 
         RowBox[{"EdgeList", "[", "g", "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"list", " ", "of", " ", "edges", " ", "of", " ", "g"}], ",", 
        " ", 
        RowBox[{"as", " ", "vtx", " ", "pairs"}]}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chordlessCycs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"pIndex", "=", "1"}], ",", " ", 
        RowBox[{"pIndex", " ", "\[LessEqual]", " ", 
         RowBox[{"Length", "@", "chordlessPaths"}]}], ",", " ", 
        RowBox[{"pIndex", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{
          "chordlessPaths", "\[LeftDoubleBracket]", "pIndex", 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{"(*", 
           RowBox[{"for", " ", "i", " ", "in", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"initialVtx", "=", 
             RowBox[{
             "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ";", " ", 
            RowBox[{"terminalVtx", "=", 
             RowBox[{"p", "\[LeftDoubleBracket]", 
              RowBox[{"-", "i"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{"(*", 
              RowBox[{
              "for", " ", "each", " ", "nbr", " ", "w", " ", "of", " ", 
               "initialVtx", " ", "not", " ", "in", " ", "p"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "p", "]"}], ">", "2"}], " ", "&&", 
                  " ", "\[IndentingNewLine]", 
                  RowBox[{"!", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SelectFirst", "[", 
                    RowBox[{
                    RowBox[{"p", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "nbrsLists", "\[LeftDoubleBracket]", "w", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "]"}], "&"}]}], 
                    "]"}], "===", 
                    RowBox[{"Missing", "[", "\"\<NotFound\>\"", "]"}]}], 
                    ")"}]}]}], 
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "an", " ", "interior", " ", "vtx", " ", "of", " ", "p", " ",
                    "is", " ", "a", " ", "nbr", " ", "of", " ", "w"}], "*)"}],
                  "\[IndentingNewLine]", ",", 
                 RowBox[{"Continue", "[", "]"}]}], 
                RowBox[{"(*", 
                 RowBox[{"adding", " ", "w", " ", 
                  RowBox[{"won", "'"}], "t", " ", "yield", " ", "chordless", 
                  " ", "path", " ", "or", " ", "cyc"}], "*)"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"newCycOrPath", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[Equal]", "1"}], ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", "w", "}"}], ",", "p"}], "]"}], ",", 
                  RowBox[{"Reverse", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{"{", "w", "}"}]}], "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{
                    "nbrsLists", "\[LeftDoubleBracket]", "terminalVtx", 
                    "\[RightDoubleBracket]"}], ",", "w"}], "]"}]}], ",", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"newCycOrPath", " ", "is", " ", "a", " ", "path"}],
                    ",", " ", 
                   RowBox[{"not", " ", "a", " ", "cycle"}]}], "*)"}], " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"w", "<", "terminalVtx"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"to", " ", "avoid", " ", "duplicates"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"chordlessPaths", ",", "newCycOrPath"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"If", " ", "w"}], " ", "<", " ", "terminalVtx"}], 
                   "*)"}], ";"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"w", "<", 
                    RowBox[{"Min", "[", "p", "]"}]}], "&&", 
                    RowBox[{"initialVtx", "<", "terminalVtx"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    "add", " ", "only", " ", "cycs", " ", "in", " ", "normal",
                     " ", "form"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"chordlessCycs", ",", "newCycOrPath"}], "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"If", " ", "w"}], "<", "Min"}], "*)"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "!"}], "MemberQ"}], "*)"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"w", ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{
                  "nbrsLists", "\[LeftDoubleBracket]", "initialVtx", 
                   "\[RightDoubleBracket]"}], ",", "p"}], "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], 
            RowBox[{"(*", "Do", "*)"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], 
         RowBox[{"(*", "Do", "*)"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"For", " ", "pIndex"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"chordlessCycs", ",", "chordlessPaths"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"Module", " ", "getChordlessCycsAndPaths"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getNbrsOfEachVtx", "[", "g_Graph", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "each", " ", "vtx", " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{
         "labeled", " ", "as", " ", "a", " ", "natural", " ", "number"}], 
         ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{
        "result", "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}], "=",
         " ", 
        RowBox[{"list", " ", "of", " ", "nbrs", " ", "of", " ", "v"}]}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"VertexList", "[", "g", "]"}], "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "result", "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"AdjacencyList", "[", 
          RowBox[{"g", ",", "v"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"VertexList", "[", "g", "]"}]}], "}"}]}], "]"}], 
      RowBox[{"(*", "Do", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"Module", " ", "getNbrsOfEachVtx"}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getGraphFromVtxPairs", "[", "vtxPairs_List", "]"}], ":=", 
    RowBox[{"Graph", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"UndirectedEdge", ",", "#"}], "]"}], "&"}], ",", "vtxPairs", 
       ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "defined", " ", "to", " ", "get", " ", "list", " ", "of", 
    " ", "edges", " ", "from", " ", "list", " ", "of", " ", "vertex", " ", 
    "pairs"}], "*)"}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"removeVtxsDeg2orLess", "[", "edgeList_List", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"degs", ",", "i", ",", 
        RowBox[{"eList", "=", "edgeList"}], ",", "pos"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "get", " ", "rid", " ", "of", " ", "all", " ", "vtxs", " ", "v", " ",
           "of", " ", "deg", " ", "2", " ", "or", " ", 
          RowBox[{"less", ":"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
         "\"\<remove\>\"", " ", "vtx", " ", "v", " ", "from", " ", "edgeList",
           " ", "by", " ", "merging", " ", "it", " ", "with", " ", "any", " ",
           "adjacent", " ", "vtx", " ", "u"}], ";", " ", 
         RowBox[{"i", ".", "e", "."}]}], ",", " ", 
        RowBox[{"contract", " ", "the", " ", "edge", " ", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}]}], ","}], " ", " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{"True", ",", 
         RowBox[{"(*", " ", 
          RowBox[{
          "keep", " ", "removing", " ", "vtx", " ", "of", " ", "deg", " ", 
           "2", " ", "until", " ", "there", " ", "are", " ", "none"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"degs", "=", 
           RowBox[{"getDegs", "[", "eList", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "}"}], "\[NotEqual]", 
             RowBox[{"(", 
              RowBox[{"pos", "=", 
               RowBox[{"Position", "[", 
                RowBox[{"degs", ",", "1"}], "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"eList", "=", 
              RowBox[{"removeVtx", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "eList"}], 
               "]"}]}], ";", 
             RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "}"}], "\[NotEqual]", 
             RowBox[{"(", 
              RowBox[{"pos", "=", 
               RowBox[{"Position", "[", 
                RowBox[{"degs", ",", "2"}], "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"eList", "=", 
              RowBox[{"removeVtx", "[", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "eList"}], 
               "]"}]}], ";", 
             RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", 
       RowBox[{"(*", " ", 
        RowBox[{"While", " ", "True"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "eList", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"removeVtx", "[", 
     RowBox[{"v_Integer", ",", "edgeList_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eList", ",", "u", ",", " ", "pos"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
         "\"\<remove\>\"", " ", "vtx", " ", "v", " ", "from", " ", "edgeList",
           " ", "by", " ", "merging", " ", "it", " ", "with", " ", "any", " ",
           "adjacent", " ", "vtx", " ", "u"}], ";", " ", 
         RowBox[{"i", ".", "e", "."}]}], ",", " ", 
        RowBox[{"contract", " ", "the", " ", "edge", " ", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "and", " ", "call", " ", "the", " ", "new", " ", "vertex", " ", 
          "u"}], ";", "\[IndentingNewLine]", 
         RowBox[{
         "find", " ", "the", " ", "first", " ", "edge", " ", "e", " ", 
          "containing", " ", "v"}], ";", " ", 
         RowBox[{
          RowBox[{"say", " ", "e"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], " ", "or", " ", 
           RowBox[{"{", 
            RowBox[{"v", ",", "u"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"remove", " ", "edge", " ", "e"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"in", " ", "the", " ", "remaining", " ", "edges"}]}], ",", 
        " ", 
        RowBox[{
         RowBox[{"replace", " ", "all", " ", 
          RowBox[{"v", "'"}], "s", " ", "with", " ", 
          RowBox[{"u", "'"}], "s"}], ";"}]}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eList", "=", "edgeList"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"eList", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"eList", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"pos", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"3", "-", 
            RowBox[{"pos", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eList", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"eList", ",", 
          RowBox[{"pos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eList", "=", 
        RowBox[{"eList", "/.", 
         RowBox[{"v", "\[Rule]", "u"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"pushDownVertices", "[", 
         RowBox[{"Union", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Sort", ",", "eList"}], "]"}], "]"}], "]"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getDegs", "[", "edgeListInput_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nVertices", ",", "flatEL"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"flatEL", "=", 
       RowBox[{"Flatten", "[", "edgeListInput", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nVertices", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"Union", "[", "flatEL", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"flatEL", ",", "#"}], "]"}], "&"}], ",", 
         RowBox[{"Range", "[", "nVertices", "]"}]}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"global", " ", 
     RowBox[{"variables", ":", "\[IndentingNewLine]", "dcm"}]}], ",", " ", 
    "bicm", ",", " ", "dcmCompact", ",", "  ", "nVertices", ","}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Create", " ", "the", " ", "following", " ", "two", " ", 
      RowBox[{"tables", ":"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"disjoint", " ", "cycles", " ", 
       RowBox[{"matrix", ":", " ", 
        RowBox[{"dcm", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
      RowBox[{
      "1", " ", "iff", " ", "cycle", " ", "i", " ", "and", " ", "cycle", " ", 
       "j", " ", "are", " ", "disjoint"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"bad", " ", "intersections", " ", "cycles", " ", 
       RowBox[{"matrix", ":", " ", 
        RowBox[{"bicm", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "=", 
      RowBox[{
      "1", " ", "iff", " ", "cycle", " ", "i", " ", "and", " ", "cycle", " ", 
       "j", " ", "have", " ", "bad", " ", "intersection"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Note", ":", " ", 
      RowBox[{
      "each", " ", "cyc", " ", "in", " ", "cycles", " ", "is", " ", "assumed",
        " ", "to", " ", "be", " ", "in", " ", "standard", " ", "position"}], 
      ":", " ", 
      RowBox[{"e", ".", "g", "."}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"standard", " ", "position", " ", "for", " ", 
      RowBox[{"{", 
       RowBox[{"3", ",", "5", ",", "4", ",", "2", ",", "8", ",", "3"}], "}"}],
       " ", "is", " ", 
      RowBox[{"{", 
       RowBox[{"2", ",", "4", ",", "5", ",", "3", ",", "8", ",", "2"}], "}"}],
       " ", 
      RowBox[{"(", 
       RowBox[{"and", " ", "not", " ", 
        RowBox[{"{", 
         RowBox[{"2", ",", "8", ",", "..."}], "}"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "cycles", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", "pre"}],
       "-", "sorted"}], ";"}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"doCycleIntersections", "[", "cycles_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", " ", "i", ",", " ", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "cycles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dcm", "=", " ", 
       RowBox[{"bicm", " ", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "len"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "len"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dcmCompact", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "len"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "len"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{"j", "\[LessEqual]", "len"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"cycleIntersection", "[", 
             RowBox[{
              RowBox[{"cycles", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"cycles", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "0", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"dcm", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", " ", 
              RowBox[{
               RowBox[{"dcm", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "1"}]}], ";", 
             " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"dcmCompact", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"dcmCompact", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "i"}], "]"}], ";"}], " ",
             ",", " ", "\[IndentingNewLine]", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"bicm", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"bicm", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], "=", "1"}]}], ";"}]}],
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "determine", " ", "whether", " ", "intersection", " ", "of", " ", 
     "cycles", " ", "c1", " ", "and", " ", "c2", " ", "is", " ", 
     RowBox[{"connected", ":", "\[IndentingNewLine]", 
      RowBox[{
      "return", " ", "0", " ", "if", " ", "the", " ", "intersection", " ", 
       "is", " ", "empty"}]}]}], ",", " ", 
    RowBox[{
    "1", " ", "if", " ", "the", " ", "intersection", " ", "is", " ", 
     "connected"}], ",", " ", 
    RowBox[{
     RowBox[{"-", "1"}], " ", "if", " ", "the", " ", "intersection", " ", 
     "is", " ", "not", " ", 
     RowBox[{"connected", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cycleIntersection", "[", 
    RowBox[{"c1_List", ",", "c2_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{"c1", ",", "c2"}], "]"}], "]"}]}], ")"}], ",", "0", ",", 
        RowBox[{"Return", "[", "0", "]"}], ",", "1", ",", 
        RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v", "\[Equal]", 
         RowBox[{"1", "+", 
          RowBox[{"Length", "[", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Sort", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"List", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"c1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                  RowBox[{"Drop", "[", 
                   RowBox[{"c1", ",", "1"}], "]"}]}], "]"}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Sort", ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"List", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"c2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                  RowBox[{"Drop", "[", 
                   RowBox[{"c2", ",", "1"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
             "]"}], "]"}]}]}], ",", "1", ",", 
        RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "a", " ", "list", " ", "of", " ", "links", " ", "from", " ",
     "dcm"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLinks", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"links", ",", "doOneRow"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"doOneRow", "[", 
        RowBox[{"i_Integer", ",", "row_List"}], "]"}], ":=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"row", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "row", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"links", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"doOneRow", "[", 
          RowBox[{"i", ",", 
           RowBox[{"dcmCompact", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "dcmCompact", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"Union", ",", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", "links", ",", "2"}], "]"}]}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLinksFullFormat", "[", "cycles_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"links", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"links", "=", 
       RowBox[{"getLinks", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cycles", "[", 
          RowBox[{"[", "a", "]"}], "]"}], ",", 
         RowBox[{"cycles", "[", 
          RowBox[{"[", "b", "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", "links"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**"}], "******)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "put", " ", "cycle", " ", "in", " ", "\"\<normal\>\"", " ", "or", " ", 
     "\"\<standard\>\"", " ", "form"}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"start", " ", "with", " ", "smallest", " ", "vertex"}], ",", " ", 
    
    RowBox[{
    "go", " ", "in", " ", "the", " ", "direction", " ", "of", " ", "smallest",
      " ", "neigbor"}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "repeat", " ", "first", " ", "vtx", " ", "at", " ", "the", 
      " ", "end"}], ";", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"e", ".", "g", "."}], ":", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"5", ",", "8", ",", "3", ",", "1", ",", "4"}], "}"}]}], " ", 
      "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3", ",", "8", ",", "5", ",", "4", ",", "1"}], 
       "}"}]}]}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalizeCycle", "[", "cycle_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pm", ",", "cyc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cyc", "=", "cycle"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pm", "=", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"cyc", ",", 
          RowBox[{"Min", "[", "cyc", "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"cyc", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"cyc", ",", 
           RowBox[{"{", 
            RowBox[{"pm", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Take", "[", 
          RowBox[{"cyc", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"pm", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cyc", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ">", 
         RowBox[{"cyc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"cyc", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cyc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
           RowBox[{"Reverse", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"cyc", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{"cyc", ",", 
        RowBox[{"cyc", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pushDownVertices", "[", "edgeList_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "edgeListNew", ",", "vtxsOld", ",", "vtxsNew", ",", 
       "lowestMissingVtx"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Relabel", " ", "the", " ", "vertices", " ", 
         RowBox[{"(", 
          RowBox[{"and", " ", "edges"}], ")"}], " ", "so", " ", "that", " ", 
         "there", " ", "are", " ", "no", " ", "missing", " ", "vtxs"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "If", " ", "the", " ", "highest", " ", "vertex", " ", "label", " ", 
         "is", " ", "larger", " ", "than", " ", "the", " ", "number", " ", 
         "of", " ", "vtxs"}]}], ",", " ", 
       RowBox[{"there", " ", "is", " ", "a", " ", "missing", " ", "vtx"}], 
       ",", " ", 
       RowBox[{
        RowBox[{
        "so", " ", "relabel", " ", "this", " ", "highest", " ", "vtx", " ", 
         "to", " ", "be", " ", "the", " ", "smallest", " ", "missing", " ", 
         "vtx"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "keep", " ", "repeating", " ", "until", " ", "there", " ", "are", " ",
          "no", " ", "missing", " ", 
         RowBox[{"vtxs", "."}]}]}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"edgeList", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vtxsNew", "=", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", "edgeList", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edgeListNew", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", "edgeList"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"vtxsNew", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ">", 
         RowBox[{"Length", "[", "vtxsNew", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lowestMissingVtx", "=", 
          RowBox[{"getLowestMissingVtx", "[", "vtxsNew", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"edgeListNew", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"edgeListNew", ",", 
            RowBox[{
             RowBox[{"vtxsNew", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
             "lowestMissingVtx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vtxsNew", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "=", 
          "lowestMissingVtx"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vtxsNew", "=", 
          RowBox[{"Sort", "[", "vtxsNew", "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", 
      RowBox[{"(*", "While", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Sort", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "edgeListNew"}], "]"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Module", "*)"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getLowestMissingVtx", "[", "vtxs_List", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", " ", 
     RowBox[{"i", "\[LessEqual]", 
      RowBox[{"Length", "[", "vtxs", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "vtxs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ">", 
        "i"}], ",", 
       RowBox[{"Return", "[", "i", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], 
  RowBox[{"(*", "For", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "===", "==="}], 
    "="}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeAllEdgePairs", "[", "edgeList_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"allEdgePairs", ",", "i", ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Create", " ", "list", " ", "of", " ", "all", " ", "pairs", " ", "of", 
       " ", "disjoint", " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allEdgePairs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"Length", "[", "edgeList", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", " ", 
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "edgeList", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"edgeList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "\[Intersection]", " ", 
              RowBox[{"edgeList", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], " ", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"allEdgePairs", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"allEdgePairs", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"edgeList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"edgeList", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "allEdgePairs", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeCrossings", "[", "edgeList_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xings", "=", 
        RowBox[{"{", "}"}]}], ",", "e", ",", " ", "i", ",", " ", "j"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "edgeList"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "e", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "e", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], " ", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"xings", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              ";", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"xings", ",", "1"}], "]"}], ";", 
              RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], "<", 
              RowBox[{"e", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"xings", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"e", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              ";", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"xings", ",", "1"}], "]"}]}]}], "]"}]}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "xings", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swap", "[", 
    RowBox[{"L_", ",", "i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lis", ":=", "L"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"lis", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ":=", 
       RowBox[{"L", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lis", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ":=", 
       RowBox[{"L", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "lis"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgePairSort", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"min1", ",", "max1", ",", "min2", ",", "max2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Sorts", " ", "a", " ", "pair", " ", "of", " ", "edges", " ", "with", 
        " ", "respect", " ", "to", " ", "each", " ", "other"}], ",", " ", 
       RowBox[{
       "without", " ", "taking", " ", "into", " ", "effect", " ", "or", " ", 
        "changing", " ", "the", " ", "order", " ", "of", " ", "vertices", " ",
         "in", " ", "each", " ", 
        RowBox[{"edge", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"min1", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"max1", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"min2", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"c", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"max2", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"c", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"min1", "<", "min2"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"min2", "<", "min1"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"max1", "<", "max2"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", "d"}], "}"}]}], "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cycsToEdgePairs", "[", 
    RowBox[{"cyc1_", ",", " ", "cyc2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"consecPairs", ",", " ", "cyc1edges", ",", " ", "cyc2edges"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"cyc1", " ", "&"}], " ", "cyc2", " ", "are", " ", "lists", 
        " ", "representing", " ", "cycles"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{
         RowBox[{"list", " ", "of", " ", "all", " ", "edge"}], "-", 
         RowBox[{
         "pairs", " ", "with", " ", "one", " ", "edge", " ", "from", " ", 
          "each", " ", "cycle"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"each", " ", "pair", " ", "is", " ", 
        RowBox[{"sorted", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"consecPairs", "[", "lis_", "]"}], ":=", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{"List", "[", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{"lis", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"Delete", "[", 
           RowBox[{"lis", ",", "1"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyc1edges", "=", 
       RowBox[{"consecPairs", "[", "cyc1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyc2edges", "=", 
       RowBox[{"consecPairs", "[", "cyc2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"List", ",", "cyc1edges", ",", "cyc2edges", ",", "1"}], 
         "]"}], ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getXingNum", "[", "ep_List", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edgePair", ",", "pos", ",", 
       RowBox[{"s", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Finds", " ", "the", " ", "crossing", " ", "number", " ", "between", 
        " ", "two", " ", "edges", " ", "in", " ", "ep", " ", 
        RowBox[{"(", 
         RowBox[{"edge", " ", "pair"}], ")"}], " ", "according", " ", "to", 
        " ", "their", " ", "listing", " ", "in", " ", "the", " ", "global", 
        " ", "variable", " ", 
        StyleBox["crossings",
         FontSlant->"Italic"]}], 
       StyleBox[";",
        FontSlant->"Italic"], 
       StyleBox["\[IndentingNewLine]",
        FontSlant->"Italic"], 
       StyleBox[
        RowBox[{
        "returns", " ", "0", " ", "if", " ", "ep", " ", "is", " ", "not", " ",
          "in", " ", "the", " ", "crossings", " ", 
         RowBox[{"list", ".", "\[IndentingNewLine]", "Format"}], " ", "for", 
         " ", 
         RowBox[{"ep", ":", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}]}],
        FontSlant->"Plain"], 
       StyleBox[";",
        FontSlant->"Plain"]}], 
      StyleBox["\[IndentingNewLine]",
       FontSlant->"Italic"], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgePair", "=", 
       RowBox[{"edgePairSort", "[", "ep", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"edgePair", "=", 
       RowBox[{"Flatten", "[", "edgePair", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "need", " ", "to", " ", "change", " ", "format", " ", "to", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], " ", "since", 
        " ", 
        RowBox[{"that", "'"}], "s", " ", "the", " ", "format", " ", "used", 
        " ", "in", " ", 
        StyleBox["crossings",
         FontSlant->"Italic"]}], 
       StyleBox[" ",
        FontSlant->"Italic"], 
       StyleBox["*)",
        FontSlant->"Plain"]}], 
      StyleBox["\[IndentingNewLine]",
       FontSlant->"Plain"], 
      StyleBox[
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgePair", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ">", 
          RowBox[{"edgePair", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"edgePair", "=", 
            RowBox[{"swap", "[", 
             RowBox[{"edgePair", ",", "1", ",", "2"}], "]"}]}], ";", 
           RowBox[{"s", "=", 
            RowBox[{"-", "1"}]}]}], ")"}]}], "]"}],
       FontSlant->"Plain"], 
      StyleBox[";",
       FontSlant->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontSlant->"Plain"], 
      StyleBox[
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"edgePair", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ">", 
          RowBox[{"edgePair", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"edgePair", "=", 
            RowBox[{"swap", "[", 
             RowBox[{"edgePair", ",", "3", ",", "4"}], "]"}]}], ";", 
           RowBox[{"s", "=", 
            RowBox[{
             RowBox[{"-", "1"}], "*", "s"}]}]}], ")"}]}], "]"}],
       FontSlant->"Plain"], 
      StyleBox[";",
       FontSlant->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontSlant->"Plain"], 
      RowBox[{"pos", ":=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"crossings", ",", "edgePair"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"pos", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"s", "*", 
          RowBox[{"Extract", "[", 
           RowBox[{"crossings", ",", 
            RowBox[{"pos", "+", "1"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "0", "]"}]}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"0", " ", "crossing", " ", "for", " ", "this", " ", "pair"}], 
     " ", "*)"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linkNum", "[", "epList_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"getXingNum", ",", "epList"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgePairSign", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Returns", " ", "+", 
       RowBox[{"1", " ", "or"}], " ", "-", 
       RowBox[{"1", " ", "according", " ", "to", " ", "the", " ", 
        RowBox[{"edges", "'"}], " ", "orientations", " ", "and", " ", "edge", 
        " ", "pair"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Sign", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"d", "-", "c"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "A", " ", "matrix", " ", "representing", " ", "a", " ", "system", " ", 
     "of", " ", "linear", " ", "equations"}], ",", " ", 
    RowBox[{
    "one", " ", "equation", " ", "for", " ", "each", " ", "link", " ", "from",
      " ", "the", " ", "input"}], ",", " ", 
    RowBox[{
     RowBox[{
     "saying", " ", "the", " ", "link", " ", "has", " ", "linking", " ", 
      "number", " ", 
      RowBox[{"zero", "."}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
     "There", " ", "is", " ", "one", " ", "variable", " ", "for", " ", "each",
       " ", "pair", " ", "of", " ", "disjoint", " ", "edges"}], ";", " ", 
     RowBox[{
     "the", " ", "variable", " ", "represents", " ", "the", " ", "number", 
      " ", "of", " ", "crossings", " ", "in", " ", "an", " ", "arbitrary", 
      " ", "embedding", " ", "of", " ", "the", " ", "graph", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "not", " ", "necessarily", " ", "the", " ", "given", " ", 
         "embedding"}], ")"}], "."}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{
     "The", " ", "equation", " ", "is", " ", "constructed", " ", "by", " ", 
      "adding", " ", "the", " ", "coefficients", " ", "of", " ", "the", " ", 
      "relavent", " ", "variables", " ", "for", " ", "each", " ", "link"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "appropriate"}], " ", "+", 
     RowBox[{
      RowBox[{"-", "1"}], " ", "multipliers"}]}], ",", " ", 
    RowBox[{
    "plus", " ", "the", " ", "\"\<current\>\"", " ", "linking", " ", "number",
      " ", 
     RowBox[{"(", 
      RowBox[{"for", " ", "the", " ", "given", " ", "embedding"}], ")"}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "setting", " ", "the", " ", "sum", " ", "equal", " ", "to", 
      " ", "zero"}], ";", "\[IndentingNewLine]", "so"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sum", " ", "of", " ", 
       RowBox[{"(", 
        RowBox[{"+", 
         RowBox[{"-", "1"}]}], ")"}], "vars"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"-", " ", "current"}], " ", "linking", " ", "number"}]}], "  ",
      ";", "\[IndentingNewLine]", 
     RowBox[{
     "the", " ", "coefficients", " ", "become", " ", "one", " ", "row", " ", 
      "of", " ", "the", " ", 
      RowBox[{"matrix", "."}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeFullAugmentedMatrix", "[", 
    RowBox[{"cycPairs_List", ",", "allEdgePairs_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "result", ",", "i", ",", "epList", ",", "maxV", ",", "newEqn", ",", 
       "temp", ",", "pos", ",", "ZEROeqn", ",", "epPositionsInZEROEQN"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "allEdgePairs", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
         "all", " ", "pairs", " ", "of", " ", "disjoint", " ", "edges", " ", 
         "in", " ", "the", " ", "graph"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "ZEROeqn", " ", "is", " ", "a", " ", "list", " ", "with", " ", "a", 
         " ", "0", " ", 
         RowBox[{"(", 
          RowBox[{"as", " ", "coeff"}], ")"}], " ", "for", " ", "each", " ", 
         "edgepair"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"which", " ", "serves", " ", "as", " ", "a", " ", 
        RowBox[{"template", "/", "blank"}], " ", "eqn"}], ",", " ", 
       RowBox[{
       "where", " ", "some", " ", "of", " ", "the", " ", "coeffs", " ", 
        "will", "\[IndentingNewLine]", "later", " ", "be", " ", "set", " ", 
        "from", " ", "0", " ", "to", " ", "nonzero"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Let", " ", "newEqn"}], " ", "=", " ", "ZEROeqn"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", " ", "each", " ", "pair", " ", "of", " ", "cycles"}]}],
        ",", " ", 
       RowBox[{
       "get", " ", "all", " ", "pairs", " ", "of", " ", "edges", " ", 
        RowBox[{"w", "/", " ", "one"}], " ", "in", " ", "each", " ", 
        "cycle"}], ",", " ", 
       RowBox[{
        RowBox[{"call", " ", "this", " ", "list", " ", "eplist"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", " ", "each", " ", "ep", " ", "in", " ", "eplist"}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"insert", " ", "sign", 
         RowBox[{"(", "ep", ")"}], " ", "into", " ", "newEqn"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "To", " ", "find", " ", "where", " ", "to", " ", "insert", " ", 
         "it"}]}], ",", " ", 
       RowBox[{
       "use", " ", "the", " ", "look", " ", "up", " ", "table", " ", 
        "epPositionsInZEROeqn"}]}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"result", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxV", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Flatten", "[", "edgeList", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"epPositionsInZEROEQN", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"Null", ",", 
         RowBox[{"{", 
          RowBox[{"maxV", ",", "maxV", ",", "maxV", ",", "maxV"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", 
         RowBox[{"Length", "@", "allEdgePairs"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"epPositionsInZEROEQN", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"allEdgePairs", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"allEdgePairs", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", "2"}], "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"allEdgePairs", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"allEdgePairs", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}], "=", "i"}], ";"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"e", ".", "g", ".", " ", "if"}], " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "}"}], " ", "is", " ", "the", 
          " ", "6", "th", " ", "element", " ", "in", " ", "allEdgePairs"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"then", " ", 
          RowBox[{"epPositionsInZEROEQN", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "4", ",", "2", ",", "3"}], 
           "\[RightDoubleBracket]"}], " ", "is", " ", "set", " ", "to", " ", 
          "6"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", "For", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ZEROeqn", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "allEdgePairs"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"epList", "=", 
          RowBox[{"cycsToEdgePairs", "[", 
           RowBox[{
            RowBox[{
            "cp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "cp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newEqn", "=", "ZEROeqn"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"temp", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Sort", "[", 
               RowBox[{"Map", "[", 
                RowBox[{"Sort", ",", "ep"}], "]"}], "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"e", ".", "g", "."}], ",", " ", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Sort", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"4", ",", "1"}], "}"}]}], "}"}]}], "]"}], "]"}], 
               " ", "gives", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "4"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"pos", "=", 
             RowBox[{"epPositionsInZEROEQN", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{
               "temp", "\[LeftDoubleBracket]", "4", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"position", " ", "of", " ", "ep"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newEqn", "\[LeftDoubleBracket]", "pos", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"edgePairSign", "[", "ep", "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"ep", ",", "epList"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], 
         RowBox[{"(*", "Do", "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"newEqn", ",", 
           RowBox[{"-", 
            RowBox[{"linkNum", "[", "epList", "]"}]}]}], "]"}], " ", ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"result", ",", "newEqn"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"cp", ",", "cycPairs"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], 
      RowBox[{"(*", "Do", "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "result", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"Module", " ", "makeFullAugmentedMatrix"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"doSetUp", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgeList", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "edgeList"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allEdgePairs", "=", 
       RowBox[{"makeAllEdgePairs", "[", "edgeList", "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "all", " ", "disjoint", " ", "pairs", " ", "of", " ", "edges", " ", 
        "in", " ", "the", " ", "graph"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"crossings", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"crossings", "=", 
         RowBox[{"makeCrossings", "[", "edgeList", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allLinks", "=", 
       RowBox[{"getChordless2Links", "[", "edgeList", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"allLinks", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fullAugmentedMatrix", "=", 
       RowBox[{"makeFullAugmentedMatrix", "[", 
        RowBox[{"allLinks", ",", "allEdgePairs"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", " ", "MAIN"}], " ", 
    RowBox[{"LOOP", " ", "**", "**"}]}], "********)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"doMainLoop", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "subAugMtx", ",", "soln", ",", "tr", ",", "indexer", ",", "A", ",", "b",
        ",", "j", ",", "\[IndentingNewLine]", "foundSolnMod2", ",", 
       RowBox[{"integerSolsCounter", "=", "0"}], ",", 
       RowBox[{"previousSoln", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "return", " ", "1", " ", "if", " ", "the", " ", "graph", " ", "is", 
        " ", "IK"}], ",", " ", 
       RowBox[{"0", " ", "if", "  ", 
        RowBox[{"can", "'"}], "t", " ", "decide"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"foundSolnMod2", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"subAugMtx", "=", "fullAugmentedMatrix"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tr", "=", 
       RowBox[{"Transpose", "[", "subAugMtx", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Drop", "[", 
         RowBox[{"tr", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"Last", "[", "tr", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"soln", "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"A", ",", "b", ",", 
         RowBox[{"Modulus", "\[Rule]", "2"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"Head", "[", "soln", "]"}], ",", "List"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"foundSolnMod2", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"soln", "=", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"A", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SameQ", "[", 
            RowBox[{
             RowBox[{"Head", "[", "soln", "]"}], ",", "List"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"IntegerQ", ",", "soln"}], "]"}], ",", "False"}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"previousSoln", "\[NotEqual]", "soln"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"previousSoln", "=", "soln"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<\\n \\n \\n \\n \\n Found integer solution: \>\"", 
                    ",", "soln", ",", " ", "\"\<\\n \\n\>\""}], "]"}], ";"}], 
                   " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"integerSolsCounter", "++"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], " ", "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Unprotect", "[", 
         RowBox[{
         "edgeList", ",", "crossings", ",", "dcm", ",", "bicm", ",", 
          "dcmCompact", ",", "allEdgePairs", ",", "allLinks", ",", 
          "fullAugmentedMatrix"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Remove", "[", 
         RowBox[{
         "edgeList", ",", "crossings", ",", "dcm", ",", "bicm", ",", 
          "dcmCompact", ",", "allEdgePairs", ",", "allLinks", ",", 
          "fullAugmentedMatrix"}], "]"}], ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"To", " ", "free", " ", "up", " ", "memory"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      RowBox[{"If", "[", 
       RowBox[{"foundSolnMod2", ",", "\[IndentingNewLine]", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<There exist mod 2 link-less embeddings, so the graph is not \
IL.\>\"", "]"}], ";"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"integerSolsCounter", "==", "0"}], ",", 
            RowBox[{
            "Print", "[", 
             "\"\<Mod 2 solutions were found; and no integer solutions were \
found. But there may still exist an integer solution: LinearSolve[] doesn't \
look for all solutions; it only tries to find one (real) solution, which may \
or may not happen to be an integer soln.\>\"", "]"}]}], "]"}], ";"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<No mod 2 link-less embeddings exist. So this graph is \
IL.\>\"", "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "1", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], " ", "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "==="}], "="}], "  ", 
   "*)"}]}]}], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"b36b3742-6506-4378-adf0-9e1976233768"]
},
WindowSize->{808, 791},
WindowMargins->{{Automatic, 1}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"29996764-658f-49b5-bb96-143aa5c0b48f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 89560, 2194, 13770, "Input",ExpressionUUID->"b36b3742-6506-4378-adf0-9e1976233768"]
}
]
*)

